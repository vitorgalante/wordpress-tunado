<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/intl-tel-input@23.8.1/build/css/intlTelInput.css">

<style>
.iti {
    width: 100%;
    position: relative;
}

.iti input,
.iti input.jet-form__field {
    width: 100%;
    box-sizing: border-box;
}

.iti input.jet-form__field.text-field {
    min-height: 40px;
}

.iti__country-list {
    max-width: 300px;
}

input.error {
    border: 2px solid #e74c3c !important;
}

@media (max-width: 768px) {
    .iti input,
    .iti input.jet-form__field {
        font-size: 16px;
    }
}
</style>

<script src="https://cdn.jsdelivr.net/npm/intl-tel-input@23.8.1/build/js/intlTelInput.min.js"></script>

<script>
(function ($) {
  if (typeof window.intlTelInput === "undefined") {
    return;
  }

  function initIntl(container) {
    const $containers = $(container).find(
      ".jet-form-field-container.phone-international"
    );

    $containers.each(function () {
      const $wrapper = $(this);
      const input = $wrapper.find('input[name="pseudo_telefone"]')[0];

      if (!input) return;

      if (input.dataset.intlInitialized === "true") {
        return;
      }

      const $form = $(input).closest("form");
      const realInput = $form.find('input[name="telefone"]')[0];

      if (!realInput) return;

      input.dataset.intlInitialized = "true";

      const iti = window.intlTelInput(input, {
        initialCountry: "br",
        preferredCountries: ["br", "us", "pt"],
        separateDialCode: true,
        nationalMode: false,
        formatOnDisplay: true,
        autoPlaceholder: "aggressive",
        strictMode: true,
        utilsScript:
          "https://cdn.jsdelivr.net/npm/intl-tel-input@23.8.1/build/js/utils.js",
      });

      function syncTelefone() {
        if (!iti.isValidNumber()) {
          realInput.value = "";
          return;
        }
        realInput.value = iti.getNumber();
      }

      input.addEventListener("input", syncTelefone);
      input.addEventListener("countrychange", syncTelefone);

      $form.on("submit", function (e) {
        if (!iti.isValidNumber()) {
          e.preventDefault();
          e.stopImmediatePropagation();
          input.classList.add("error");
          alert("Por favor, insira um telefone válido.");
        }
      });

      input.addEventListener("input", function () {
        input.classList.remove("error");
      });
    });
  }

  // Formulários visíveis
  $(document).ready(function () {
    initIntl(document);
  });

  // Formulários dentro de popup Elementor
  $(window).on("elementor/popup/show", function (event, id) {
    const $popup = $("#elementor-popup-modal-" + id);
    if (!$popup.length) return;

    setTimeout(function () {
      initIntl($popup[0]);
    }, 50);
  });
})(jQuery);
</script>





